@page {
	size: var(--print-width) var(--print-height);
	margin: 0;
}
html, body {
	padding: 0;
	margin: 0;
}
body,
body > element-template > .view {
	display:flex;
	flex-wrap: wrap;
	align-items: center;
	justify-content: center;
}

.page-sheet {
	display:block;
	position:relative;
	page-break-after: always;
	counter-increment: sheet;
	z-index:0;
	flex: 0 0 auto;
	width: var(--page-width);
	height: var(--page-height);
	padding: var(--page-margin);
	overflow:hidden;
}
.page-sheet::before {
	content:'';
	position:absolute;
	background-color:var(--color);
	background-image:var(--image);
	background-size: var(--size-w, auto) var(--size-h, auto);
	background-repeat:var(--repeat);
	background-position: var(--position, auto);
	inset:
		var(--top, var(--page-margin))
		var(--page-margin)
		var(--page-margin)
		var(--left, var(--page-margin));
	z-index: -1;
	pointer-events: none;
	background-origin: content-box;
}
.page-sheet.bleed-left::before {
	left: 0;
}
.page-sheet.bleed-right::before {
	right: 0;
}
.page-sheet.bleed-top::before {
	top: 0;
}
.page-sheet.bleed-bottom::before {
	bottom: 0;
}

body[data-fold-width] .page-sheet-right:not(.bleed-right):has(+ .page-sheet-left:not(.bleed-left)) {
	/* (no bleed) + no bleed */
	width: calc(var(--page-width) + var(--page-fold-width) / 2);
	padding-right: var(--page-fold-width / 2);
}
body[data-fold-width] .page-sheet-right:not(.bleed-right) + .page-sheet-left:not(.bleed-left) {
	/* no bleed + (no bleed) */
	width: calc(var(--page-width) + var(--page-fold-width) / 2);
	padding-left: var(--page-fold-width / 2);
}

body[data-fold-width] .page-sheet-right.bleed-right:has(+ .page-sheet-left:not(.bleed-left)) {
	/* (bleed) + no bleed */
	width: calc(var(--page-width) + var(--page-fold-width));
	padding-right: var(--page-fold-width);
}
body[data-fold-width] .page-sheet-right.bleed-right + .page-sheet-left:not(.bleed-left) {
	/* bleed + (no bleed) */
	padding-left:0;
}

body[data-fold-width] .page-sheet-right:not(.bleed-right):has(+ .page-sheet-left.bleed-left) {
	/* (no bleed) + bleed */
	padding-right:0;
}
body[data-fold-width] .page-sheet-right:not(.bleed-right) + .page-sheet-left.bleed-left {
	/* no bleed + (bleed) */
	width: calc(var(--page-width) + var(--page-fold-width));
	padding-left: var(--page-fold-width);
}

body[data-fold-width] .page-sheet-right.bleed-right:has(+ .page-sheet-left.bleed-left) {
	/* (bleed) + bleed */
	width: calc(var(--page-width) + var(--page-fold-width) / 2);
	padding-right: var(--page-fold-width / 2);
}
body[data-fold-width] .page-sheet-right.bleed-right + .page-sheet-left.bleed-left {
	/* bleed + (bleed) */
	width: calc(var(--page-width) + var(--page-fold-width) / 2);
	padding-left: var(--page-fold-width / 2);
}

.page-sheet-error {
	outline: 8px dashed red;
}

body[data-fold-width] .page-sheet-right {
	margin-right:0;
	page-break-after: avoid;
}

body[data-fold-width] .page-sheet-left {
	margin-left:0;
}

body[data-fold-width] .page-sheet-right:not(.bleed-right):has(+ .page-sheet-left:not(.bleed-left))::before {
	/* (no bleed) + no bleed */
	right: calc(var(--page-fold-width) / 2);
}
body[data-fold-width] .page-sheet-right:not(.bleed-right) + .page-sheet-left:not(.bleed-left)::before {
	/* no bleed + (no bleed) */
	left: calc(var(--page-fold-width) / 2);
}

body[data-fold-width] .page-sheet-right.bleed-right:has(+ .page-sheet-left:not(.bleed-left))::before {
	/* (bleed) + no bleed */
	right:0;
}
body[data-fold-width] .page-sheet-right.bleed-right + .page-sheet-left:not(.bleed-left)::before {
	/* bleed + (no bleed) */
	left: 0;
}

body[data-fold-width] .page-sheet-right:not(.bleed-right):has(+ .page-sheet-left.bleed-left)::before {
	/* (no bleed) + bleed */
	right:0;
}
body[data-fold-width] .page-sheet-right:not(.bleed-right) + .page-sheet-left.bleed-left::before {
	/* no bleed + (bleed) */
	left:0;
}

body[data-fold-width] .page-sheet-right.bleed-right:has(+ .page-sheet-left.bleed-left)::before {
	/* (bleed) + bleed */
	right:0;
}
body[data-fold-width] .page-sheet-right.bleed-right + .page-sheet-left.bleed-left::before {
	/* bleed + (bleed) */
	left:0;
}

body[data-fold-width] .page-sheet-right:not(.bleed-right):has(+ .page-sheet-left:not(.bleed-left))::after {
	/* (no bleed) + no bleed */
	right: calc(var(--page-fold-width) / 2);
}
body[data-fold-width] .page-sheet-right:not(.bleed-right) + .page-sheet-left:not(.bleed-left)::after {
	/* no bleed + (no bleed) */
	left: calc(var(--page-fold-width) / 2);
}

body[data-fold-width] .page-sheet-right.bleed-right:has(+ .page-sheet-left:not(.bleed-left))::after {
	/* (bleed) + no bleed */
	right:var(--page-fold-width);
}
body[data-fold-width] .page-sheet-right.bleed-right + .page-sheet-left:not(.bleed-left)::after {
	/* bleed + (no bleed) */
	left: 0;
}

body[data-fold-width] .page-sheet-right:not(.bleed-right):has(+ .page-sheet-left.bleed-left)::after {
	/* (no bleed) + bleed */
	right:0;
}
body[data-fold-width] .page-sheet-right:not(.bleed-right) + .page-sheet-left.bleed-left::after {
	/* no bleed + (bleed) */
	left:var(--page-fold-width);
}

body[data-fold-width] .page-sheet-right.bleed-right:has(+ .page-sheet-left.bleed-left)::after {
	/* (bleed) + bleed */
	right:calc(var(--page-fold-width) / 2);
}
body[data-fold-width] .page-sheet-right.bleed-right + .page-sheet-left.bleed-left::after {
	/* bleed + (bleed) */
	left:calc(var(--page-fold-width) / 2);
}

.layout.bleed-left {
	margin-left: calc(-1 * var(--page-margin));
	border-left: var(--page-margin) solid transparent;
}
.layout.bleed-right {
	margin-right: calc(-1 * var(--page-margin));
	border-right: var(--page-margin) solid transparent;
}
.layout.bleed-top {
	margin-top: calc(-1 * var(--page-margin));
	border-top: var(--page-margin) solid transparent;
}
.layout.bleed-bottom {
	margin-bottom: calc(-1 * var(--page-margin));
	border-bottom: var(--page-margin) solid transparent;
}

.page-sheet-count[data-separator]::before {
	content: counter(sheet) " " attr(data-separator) " " counter(sheets);
}
.page-sheet-count:not([data-separator])::before {
	content: counter(sheet);
}

.page-sheet-match {
	visibility: hidden;
}
[contenteditable] .page-sheet-match,
.page-sheet-left .page-sheet-match[data-match="left"],
.page-sheet-right .page-sheet-match[data-match="right"],
.page-sheet-first .page-sheet-match[data-match="first"],
.page-sheet-last .page-sheet-match[data-match="last"] {
	visibility:initial;
}

@media screen {
	html, body {
		background: gray;
	}
	.page-sheet {
		margin: 1rem;
		background: white;
		box-shadow: rgb(0 0 0 / 40%) 0.2em 0.2em 0.4em;
	}
	body {
		width: calc(var(--print-width) + 2rem);
		flex: 1 0 auto;
		overflow: auto;
	}
	body + div.pdf-menu {
		top: 0%;
		left: 0%;
		position: fixed;
		margin:0.2em;
		font-size: 2rem;
		z-index: 2147483647;
	}
	body + div.pdf-menu > a {
		color: white;
		opacity:0.9;
		margin:0.2em;
		background: black;
		border-radius: 0.5em;
		text-align: center;
		padding: 0rem 1rem 0.5rem;
		box-shadow: rgb(0 0 0 / 20%) 0px 0.2em 0.5em -0.1em;
		text-shadow: white 0.1em 0.1em 0.5em;
		z-index: 1;
	}
	body + div.pdf-menu > a:visited {
		color:white;
	}

	.page-sheet::after {
		content:'';
		position:absolute;
		inset:
			var(--page-margin, 0)
			var(--page-margin, 0)
			var(--page-margin, 0)
			var(--page-margin, 0);
		border-width:
			min(1px, var(--page-margin, 0))
			min(1px, var(--page-margin, 0))
			min(1px, var(--page-margin, 0))
			min(1px, var(--page-margin, 0));
		border-style: dashed;
		z-index: 1;
		pointer-events: none;
	}
}

@media print {
	html, body {
		background:white;
	}
	.page-sheet-right {
		padding-right: 0;
	}
	.page-sheet-left {
		padding-left: 0;
	}
	body + div.pdf-menu {
		display:none;
	}
}
